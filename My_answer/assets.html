<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title></title>
	<link rel="stylesheet" href="./css/simple-line-icons.min.css" type="text/css">
	<script src="https://code.jquery.com/jquery.js"></script>
	<link rel="stylesheet" href="./css/bootstrap.min.css" type="text/css">
	<script src="./js/jquery-3.6.0.slim.min.js"></script>
	<script src="./js/bootstrap.min.js"></script>
	<script type="text/javascript" src="./js/Chart.min.js"></script>


	<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>



</head>

<body>
	<div class="container">
		<div class="row justify-content-center my-2">
			<div class="col-2 m-1 row border  align-items-center">
				<div class="col-2">
					<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor"
						style="color:#17a2b8;" class="bi bi-collection" viewBox="0 0 16 16">
						<path
							d="M2.5 3.5a.5.5 0 0 1 0-1h11a.5.5 0 0 1 0 1h-11zm2-2a.5.5 0 0 1 0-1h7a.5.5 0 0 1 0 1h-7zM0 13a1.5 1.5 0 0 0 1.5 1.5h13A1.5 1.5 0 0 0 16 13V6a1.5 1.5 0 0 0-1.5-1.5h-13A1.5 1.5 0 0 0 0 6v7zm1.5.5A.5.5 0 0 1 1 13V6a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5h-13z" />
					</svg>
				</div>
				<div class="col-9">
					<h4 class="text-info" id="totalCount">0</h4>
					<p>資產總數</p>
				</div>
			</div>
			<div class="col-2 m-1 row border border-2 align-items-center">
				<div class="col-2 ">
					<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor"
						style="color:#28a745;" class="bi bi-check-circle" viewBox="0 0 16 16">
						<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
						<path
							d="M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z" />
					</svg>
				</div>
				<div class="col-9">
					<h4 class="text-success" id="todayReturn">0</h4>
					<p><small>今日回報數</small></p>
				</div>
			</div>
			<div class="col-2 m-1 border border-2 row align-items-center">
				<div class="col-2">
					<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor"
						style="color:#dc3545;" class="bi bi-x-circle " viewBox="0 0 16 16">
						<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
						<path
							d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />
					</svg>
				</div>
				<div class="col-9">
					<h4 class="text-danger" id="todayUReturn">0</h4>
					<small>今日未回報數</small>
				</div>
			</div>
			<div class="col-2 m-1 border border-2 row align-items-center ">
				<div class="col-2">
					<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor"
						style="color:#6c757d;" class="bi bi-question-circle" viewBox="0 0 16 16">
						<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
						<path
							d="M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286zm1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94z" />
					</svg>
				</div>
				<div class="col-9">
					<h4 class="text-secondary" id="ManeydayUReturn">0</h4>
					<p><small>30天未回報數</small></p>
				</div>
			</div>

			<div class="col-2 m-1 border border-2 row align-items-center justify-content-center">
				<div>
					<div>
						<p>部門
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
								class="bi bi-card-list" viewBox="0 0 16 16">
								<path
									d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h13zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-13z" />
								<path
									d="M5 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 5 8zm0-2.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm0 5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm-1-5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0zM4 8a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0zm0 2.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0z" />
							</svg>
						</p>
					</div>
					<div>
						<select class="form-select" aria-label="Default select example">
							<option selected>全部</option>
							<option value="1">One</option>
							<option value="2">Two</option>
							<option value="3">Three</option>
						</select>
					</div>
				</div>

			</div>
			<div class="col m-1 border border-2 row align-items-center">
				<p>本部<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor"
						class="bi bi-question-circle-fill" viewBox="0 0 16 16">
						<path
							d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.496 6.033h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286a.237.237 0 0 0 .241.247zm2.325 6.443c.61 0 1.029-.394 1.029-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94 0 .533.425.927 1.01.927z" />
					</svg>
				</p>
				<button type="button" class="btn btn-secondary">選擇分站</button>
			</div>
		</div>
		<div class="row  justify-content-center">
			<div class="col ">
				<div class="accordion" id="accordionExample">
					<!-- First Accordion Item -->
					<div class="card">
						<div class="card-header row" id="headingOne">
							<div class="col-11 nav nav-tabs" id="myTab" style="border-bottom: 0;">
								<button class="btn-secondary  nav-link m-1" data-toggle="tab"
									href="#systemtag">作業系統</button>
								<button class="btn-secondary  nav-link m-1" data-toggle="tab" href="#IE">Internet
									Explorer</button>
								<button class="btn-secondary  nav-link m-1" data-toggle="tab" href="#Google">Google
									Chrome</button>
								<button class="btn-secondary  nav-link m-1" data-toggle="tab"
									href="#Firefox">Firefox</button>
								<button class="btn-secondary  nav-link m-1" data-toggle="tab" href="#Edge">Edge</button>
								<button class="btn-secondary  nav-link m-1" data-toggle="tab" href="#Java">Java</button>
								<button class="btn-secondary nav-link m-1" data-toggle="tab" href="#AS">防毒軟體</button>
								<button class="btn-secondary  nav-link m-1" data-toggle="tab" href="#Flash">Flash
									Player</button>
								<button class="btn-secondary  nav-link m-1" data-toggle="tab" href="#Adobe">Adobe
									Reader</button>
							</div>

							<div class="col nav nav-tabs tab-content row" style="border-bottom: 0;">
								<div class="col-1">
									<svg xmlns="http://www.w3.org/2000/svg" data-toggle="collapse"
										data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne"
										width="16" height="16" fill="currentColor" class="bi bi-chevron-up"
										viewBox="0 0 16 16">
										<path fill-rule="evenodd"
											d="M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6z" />
									</svg>
								</div>
							</div>
						</div>

						<div id="collapseOne" class="collapse show" aria-labelledby="headingOne"
							data-parent="#accordionExample">
							<div class="tabbable" id="tabs-516582">
								<!-- 摺疊選項 1 -->
								<div class="card card-body accordion" id="accordionExample">
									<div class="row-fluid">
										<div class="span6">

											<div class="tab-content m-2">
												<div class="tab-pane active" id="systemtag">
													<div class="row">
														<div class="" style="width: 150px;">
															<!-- 左邊圓餅圖 -->
															<canvas id="L_pie_system" width="400" height="400"></canvas>
														</div>
														<div class="col">
															<h3>
																作業系統
															</h3>
															<div>
																<em class="text-info"
																	id="agentSoftInfo_system">作業系統內容，待接API...</em>
															</div>
														</div>
													</div>

												</div>
												<div class="tab-pane" id="IE">
													<div class="" style="width: 150px;">
														<!-- 左邊圓餅圖 -->
														<canvas id="L_pie_IE" width="400" height="400"></canvas>
													</div>
													<div class="col">
														<h3>
															Internet Explorer
														</h3>
														<div>
															<em>Internet Explorer內容，待接API...</em>
														</div>
													</div>
												</div>
												<div class="tab-pane" id="Google">
													<div class="" style="width: 150px;">
														<!-- 左邊圓餅圖 -->
														<canvas id="L_pie_Google" width="400" height="400"></canvas>
													</div>
													<div class="col">
														<h3>
															Google Chrome
														</h3>
														<div>
															<em>Google Chrome內容，待接API...</em>
														</div>
													</div>
												</div>
												<div class="tab-pane" id="Firefox">
													<div class="" style="width: 150px;">
														<!-- 左邊圓餅圖 -->
														<canvas id="L_pie_Firefox" width="400" height="400"></canvas>
													</div>
													<div class="col">
														<h3>
															Firefox
														</h3>
														<div>
															<em>Firefox內容，待接API...</em>
														</div>
													</div>
												</div>
												<div class="tab-pane" id="Edge">
													<div class="" style="width: 150px;">
														<!-- 左邊圓餅圖 -->
														<canvas id="L_pie_Edge" width="400" height="400"></canvas>
													</div>
													<div class="col">
														<h3>
															Edge
														</h3>
														<div>
															<em>Edge內容，待接API...</em>
														</div>
													</div>
												</div>
												<div class="tab-pane" id="Java">
													<div class="" style="width: 150px;">
														<!-- 左邊圓餅圖 -->
														<canvas id="L_pie_Java" width="400" height="400"></canvas>
													</div>
													<div class="col">
														<h3>
															Java
														</h3>
														<div>
															<em>Java內容，待接API...</em>
														</div>
													</div>
												</div>
												<div class="tab-pane" id="AS">
													<div class="" style="width: 150px;">
														<!-- 左邊圓餅圖 -->
														<canvas id="L_pie_AS" width="400" height="400"></canvas>
													</div>
													<div class="col">
														<h3>
															防毒軟體
														</h3>
														<div>
															<em>防毒軟體內容，待接API...</em>
														</div>
													</div>
												</div>
												<div class="tab-pane" id="Flash">
													<div class="" style="width: 150px;">
														<!-- 左邊圓餅圖 -->
														<canvas id="L_pie_Flash" width="400" height="400"></canvas>
													</div>
													<div class="col">
														<h3>
															Flash Player
														</h3>
														<div>
															<em>Flash Player內容，待接API...</em>
														</div>
													</div>
												</div>
												<div class="tab-pane" id="Adobe">
													<div class="" style="width: 150px;">
														<!-- 左邊圓餅圖 -->
														<canvas id="L_pie_Adobe" width="400" height="400"></canvas>
													</div>
													<div class="col">
														<h3>
															Adobe Reader
														</h3>
														<div>
															<em>Adobe Reader內容，待接API...</em>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="span6">
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>

			</div>
			<div class="col ">
				<div class="card">
					<div class="card-header " id="headingOne">
						<div style="display: inline-block;">最近30天的回報狀況</div>
						<svg xmlns="http://www.w3.org/2000/svg" data-toggle="collapse" style="float: right;"
							data-target="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo" width="16"
							height="16" fill="currentColor" class="bi bi-chevron-up" viewBox="0 0 16 16">
							<path fill-rule="evenodd"
								d="M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6z" />
						</svg>
					</div>

					<div id="collapseTwo" class="collapse show" aria-labelledby="headingOne"
						data-parent="#accordionExampleTwo">
						<div class="tabbable" id="tabs-516582">
							<!-- 摺疊選項 1 -->
							<div class="card card-body accordion" id="accordionExampleTwo">
								<canvas id="R_line" width="400" height="400"></canvas>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>



	<!-- API -->
	<script>
		//gcb.json-↓↓--(內有左下角作業系統訊息)----------------------------------
		axios.get('https://cdn.jsdelivr.net/gh/IsFlyingDream/test_project/API_response/gcb.json')
			.then(res => {
				const agentPassStat = res.data.results.agentPassStat;
				const agentSoftInfo = res.data.results.agentSoftInfo;


				$('#totalCount').html(agentPassStat.total);


				//左下角作業系統訊息start-↓↓--------------------------------			

				//1.作業系統↓↓------------------------------------------------
				for (let i = 0; i < agentSoftInfo.length; i++) {

					if (agentSoftInfo[i].name == "Operation System") {
						let otherNum = 0;//other數量
						let WindowsNum = 0;//Windows數量
						let LinuxNum = 0;//Linux數量
						let FirefoxNum = 0;//Firefox數量
						for (let j = 0; j < agentSoftInfo[i].list.length; j++) {//顯示文字

							let list = agentSoftInfo[i].list[j];

							if (j == 0) {
								$('#agentSoftInfo_system').html(list.version + " - " + list.count + " 台 <br>");
							} else {
								$('#agentSoftInfo_system').append(list.version + " - " + list.count + " 台 <br>");
							}
							if (list.version.includes("Windows") == true) {
								WindowsNum++;
							} else if (list.version.includes("Linux") == true) {
								LinuxNum++;
							} else if (list.version.includes("Firefox") == true) {
								FirefoxNum++;
							} else {
								otherNum++;
							}
						}

						//顯示圓餅圖圖形資料↓↓---------------------------------
						/*色票
							'rgba(214, 243, 231, 1)',
							'rgba(173, 251, 218, 1)',
							'rgba(173, 236, 204, 1)',
							'rgba(160, 220, 196, 1)',
							'rgba(118, 208, 164, 1)'
						*/
						var ctx = document.getElementById('L_pie_system');
						var myChart = new Chart(ctx, {
							type: 'doughnut', //圖表類型
							data: {//設定圖表資料
								//標題
								labels: ['others', 'Windows', 'Linux', 'Firefox'],
								datasets: [{
									label: '# test', //標籤
									data: [otherNum, WindowsNum, LinuxNum, FirefoxNum], //資料
									//圖表背景色
									backgroundColor: [
										'rgba(214, 243, 231, 1)',
										'rgba(173, 251, 218, 1)',
										'rgba(160, 220, 196, 1)',
										'rgba(118, 208, 164, 1)'
									],
									hoverOffset: 4,
								}]
							},
							options: {//圖表的一些其他設定，像是hover時外匡加粗
								// 圖例
								legend: {
									display: false,
								},
							}
						});

						//顯示圓餅圖圖形資料↑↑---------------------------------
					}
				}
				//1.作業系統↑↑------------------------------------------------

				//2.Internet Explorer↓↓------------------------------------------------

				//<<<<待處理...>>>>>

				//2.Internet Explorer↑↑------------------------------------------------
				/*
					L_pie_system
					L_pie_Google
					L_pie_Firefox
					L_pie_Edge
					L_pie_Java
					L_pie_AS
					L_pie_Flash
					L_pie_Adobe
				*/

				//左下角作業系統訊息end-↑↑--------------------------------
			})


		//assets_今日回報數.json-↓↓------------------------------------
		axios.get('https://cdn.jsdelivr.net/gh/IsFlyingDream/test_project/API_response/assets_%E4%BB%8A%E6%97%A5%E5%9B%9E%E5%A0%B1%E6%95%B8.json')
			.then(res => {
				const todayReturn = res.data.results.totalRow;
				$('#todayReturn').html(todayReturn);

			})
		//assets_今日回報數.json-↑↑------------------------------------

		//assets_今日未回報數.json-↓↓------------------------------------
		axios.get('https://cdn.jsdelivr.net/gh/IsFlyingDream/test_project/API_response/assets_%E4%BB%8A%E6%97%A5%E6%9C%AA%E5%9B%9E%E5%A0%B1%E6%95%B8.json')
			.then(res => {
				const todayUReturn = res.data.results.totalRow;
				$('#todayUReturn').html(todayUReturn);
			})
		//assets_今日未回報數.json-↑↑------------------------------------

		//assets_30天未回報數.json-↓↓------------------------------------
		axios.get('https://cdn.jsdelivr.net/gh/IsFlyingDream/test_project/API_response/assets_30%E5%A4%A9%E6%9C%AA%E5%9B%9E%E5%A0%B1%E6%95%B8.json')
			.then(res => {
				const ManeydayUReturn = res.data.results.totalRow;
				$('#ManeydayUReturn').html(ManeydayUReturn);


				//右邊線條圖表顯示start↓↓------------------------------------
				const agents = res.data.results.agents;

				let agentsCount = 0;
				let detaStr = [];//未回報日期
				let deteNum = [];//未回報數量
				for(let i =0 ; i<agents.length ; i++){	
					let agentsString = 	agents[i].createdAt.slice(0,10);
					if(i==0){
						detaStr.push(agentsString);
						agentsCount=1;
					}else if(agentsString==detaStr[detaStr.length-1]){
						agentsCount++;
					}else{
						detaStr.push(agentsString);
						deteNum.push(agentsCount);
						agentsCount=1;
					}									
				}

				console.log("agents.length="+agents.length);	
				console.log("detaStr="+detaStr[detaStr.length-1]+" /deteNum="+deteNum[deteNum.length-1]);	
				
				var ctx = document.getElementById('R_line');
				var myChart = new Chart(ctx, {
					type: 'line', //圖表類型
					data: {//設定圖表資料
						//標題						
						labels: detaStr,//labels: ['日期1', '日期2', '日期3', '日期4', '日期5', '日期6'],
						datasets: [{
							label: 'My First Dataset',
							data: deteNum,//data: [2540, 2540, 2540, 2540, 2540, 2540, 2540],
							fill: false,
							borderColor: [
								'rgb(238, 133, 116)',
							],
							tension: 0.1
						},
						
						]
					},
					options: {//圖表的一些其他設定，像是hover時外匡加粗
						// 圖例
						legend: {
							display: false,
						},

					},
					
				});

				//右邊線條圖表顯示end↑↑------------------------------------
			})

		//assets_30天未回報數.json-↑↑------------------------------------





	</script>


</body>


</html>